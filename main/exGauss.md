<!-- Oracle 转型 GaussDB -->

> ### 1. 应用场景

?> <b> Oracle 转型 Gauss </b><br>
<br>
随着 Oracle 退出，为了响应国产化政策，国企大型应用数据库，从 Oracle 转型为 Mysql、GaussDB。 <br>
高斯 GaussDB 是华为研发的数据库，官方连接工具为 TPDSS。

> ### 2. 高斯兼容性

?> 简述高斯与 Oracle 常见的区别

```  
1、 高斯 insert 不支持别名
2、 高斯不支持 rowid、insert all into、SYSTIMESTAMP()
3、 oracle 字段名默认大写，高斯默认小写
4、 高斯 日期加减与 Oracle 不同
5、 高斯 比较运算符 >= <= 中间不能有空格
6、 oracle 随机数 .xxxx ，高斯 随机数 0.xxxxxx
7、 高斯 count 统计类型默认 Long，强转 Bigdecimal、String 会报错，转 String 需加上 to_char()
8、 高斯嵌套函数运行效率极差，多次查询的相同数据，建议提取作为常量，或放进缓存中
9、 二者时间戳保存格式有所差异，但对程序未见有影响
```

> ### 3. 测试流程

?> 简述转型测试阶段、注意事项

```  
三个阶段：
1、 Oracle 为主，双写高斯
2、 高斯为主，双写 Oracle
3、 Oracle 为主，双写高斯
4、 高斯为主，断双写 Oracle

一阶段，高斯建库建表，Oracle 分两次同步到高斯，先保证正式表数据同步正常，再过渡到辅表（temp、error、log），测试表数据的兼容性
二阶段，高斯为主数据库，全量测试和修改存过代码的兼容性，数据正常同步到 Oracle 
三阶段，切回一阶段模式，全量测试保证程序正常，作为应急手段，生产异常支持回退 Oracle，且不造成数据紊乱
四阶段，高斯断开 Oracle 的双写，针对生产报错，对同性问题进行整理，并梳理全量代码，查漏补缺


测试内容：表存过、批量、接口、渠道端

测试顺序：
一阶段，测试全部批量和关键业务，熟悉存过各个分支，方便后面阶段快速过全量测试，梳理存过的过程比较冗杂晦涩
二阶段，全量测试，先测试批量和接口，测完接口基本能覆盖渠道端，最后在页面点点点，保证业务流程正常
三阶段，全量测试，保证高斯的代码改动，不影响 Oracle 回切
四阶段，全量测试，侧重于重要业务，跟踪生产问题


高斯测试注意事项：
1、 存量接口测试，优先测自动化案例，无案例取接口文档分析，无接口文档找研发梳理分支，提供存过、代码逻辑
2、 批量测试，检查导入导出数据的格式，关注数据量过大时的处理效率
3、 常见兼容性问题是，查询报错，高斯返回 count 类型默认 Long，强转 Bigdecimal、String 会报错
4、 常见生产问题是，批量处理大数据量时，嵌套函数导致查询效率极差
5、 自动化作为收尾工作，梳理完所有批量和接口后，便于补充之前遗漏的分支场景
6、 总结兼容性问题，作为后续其他部门改造的参考文档
```  