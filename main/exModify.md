<!-- 大型应用规范化 -->

?> 一盘散沙的代码，拆分规划重组，构建井然有序、互不干扰的格局。 <br>
规范化改动测试，多少有点抽象 = =

> ### 1. 服务解耦

```
下游不再提供服务，提出解耦

研发：重写服务化接口，提供一个解耦开关（0-关，100-开）
测试：代码不可视，需要研发提供不同分支的日志打印，测试开关是否真正切换平台服务，联测下游核对执行结果
自闭法，开-走我方平台时，禁用该服务，如果还能返回成功，危
```

> ### 2. 服务迁节点

```
早期服务接口少，想哪写哪，后面需求上来，一堆奇怪的服务呆在和命名毫不相干的节点上
排查报错时，要拉所有节点日志一起看，折磨

研发：将错误的服务回归正确的节点，在正确的节点上复制相同的服务，保留旧服务，提供过渡开关（0-100百分比），保证生产正常
测试：一测服务正常，二测开关正常
一测，同一服务存在多个节点端口，把其他节点的端口禁用，测试单个节点服务
二测，所有端口打开，0-旧服务、100-新服务，且对应的节点打印日志
非0、100，随机调用服务，调到哪个服务，哪个节点有日志
```

> ### 3. 旧节点迁新节点

```
旧节点命名不规范，看着联想不到是什么业务

研发：复制旧节点改名，服务也全部拷贝搬过去，提供过渡开关（0-100百分比）
测试：好好好，这么玩是吧
和服务迁节点类似，测试范围由局部变成全量，保证双节点服务正常，兼顾开关过渡流畅
```

> ### 4. 节点迁群组

```
又是群组命名不规范，所有节点搬家到新群组，有节点住单人间，有节点住六人间

研发：一样的啦，全量测试走起
测试：好好好
```

> ### 5. 批量转型

```
老 batch 生活在黑暗的命令行里，杂乱的日志看不出来走到哪了，哪又不舒服了
新 DBF 界面化，提供执行的所有记录，可查看具体步骤报错、运行效率

研发：老批量存过修修补补，兼容新批量，不兼容则重写，提升运行效率，提供切换开关
测试：测试新旧批量，梳理存过分支
导入文件，表数据一致
导出文件，文件数据格式一致，空跑时，保证临时路径能生成空文件
跨境批量，大数据量测试运行效率
```

> ### 6. 数据库转型

具体参考：[Oracle 转型 GuassDB](main/exGauss.md)

```
国产的规范化，由于种种原因，而不得不

研发：建库建表，同步数据，从双写到断双写，涉及兼容性，大量的存过和代码改写
测试：表、存过、批量、接口、渠道端，按顺序兼顾
四个阶段侧重点不同
Oracle 双写其他数据库，侧重于数据正常、存过梳理、批量通过性验证
其他数据库双写 Oracle，侧重于服务正常、存过修改、接口、批量通过性验证
Oracle 回切，侧重于接口、批量通过性验证
断双写，侧重于渠道端流程正常，梳理同类兼容性问题是否有遗漏，关注生产问题
```

> ### 7. 数据库去存过

```
存过重写成服务化接口，服务更多人

研发：新增服务化接口，提供切换开关，涉及该存过的程序接入开关
测试：关-存过，开-服务化接口，测试相关程序，日志会打印存过名称、服务化接口
```

> ### 8. 低效退出

```
太久没人用，清理落灰代码（表、存过、代码、湖表）

研发：删删删，爽
测试：未知的恐惧，全量测试走起
不清楚哪里会调到被删的代码，表、批量、接口、渠道端需要通过性验证
```

